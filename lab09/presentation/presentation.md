---
## Front matter
lang: ru-RU
title: Лабораторная работа №9
subtitle: Лабораторная работа № 9. Использование протокола STP. Агрегирование каналов
author:
  - Джахангиров Илгар Залид оглы
institute:
  - Российский университет дружбы народов, Москва, Россия

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
---

# Информация

## Докладчик

:::::::::::::: {.columns align=center}
::: {.column width="70%"}

  * Джахангиров Илгар Залид оглы
  * студент
  * Российский университет дружбы народов
  * [1032225689@pfur.ru]

:::
::::::::::::::

## Цель работы

Изучить возможности протокола STP и его модификаций по обеспечению
отказоустойчивости сети, агрегированию интерфейсов и перераспределению
нагрузки между ними.

## Задание

1. Сформировать резервное соединение между коммутаторами msk-donskayasw-1 и msk-donskaya-sw-3.

2. Настроить балансировку нагрузки между резервными соединениями.

3. Настроить режим Portfast на тех интерфейсах коммутаторов, к которым подключены серверы.

4. Изучить отказоустойчивость резервного соединения.

5. Сформировать и настроить агрегированное соединение интерфейсов Fa0/20 -- Fa0/23 между коммутаторами msk-donskaya-sw-1 и msk-donskaya-sw-4.

6. При выполнении работы необходимо учитывать соглашение об именовании.

## Выполнение лабораторной работы

Сформируем резервное соединение между коммутаторами msk-donskayasw-1 и msk-donskaya-sw-3 (рис. [-@fig:001]). Для этого:

- заменим соединение между коммутаторами msk-donskaya-sw-1(Gig0/2) и msk-donskaya-sw-4 (Gig0/1) на соединение между коммутаторами msk-donskaya-sw-1 (Gig0/2) и msk-donskaya-sw-3 (Gig0/2);
  
- сделаем порт на интерфейсе Gig0/2 коммутатора msk-donskaya-sw-3 транковым (рис. [-@fig:002]);

- соединение между коммутаторами msk-donskaya-sw-1 и msk-donskayasw-4 сделаем через интерфейсы Fa0/23, не забыв активировать их в транковом режиме (рис. [-@fig:003,-@fig:004]).

## Выполнение лабораторной работы

![Логическая схема локальной сети с резервным соединением](image/3.png)

![Настройка trunk-порта на интерфейсе на интерфейсе Fa0/23 коммутатора msk-donskaya-sw-1](image/1.png)

## Выполнение лабораторной работы

![Настройка trunk-порта на интерфейсе на интерфейсе Fa0/23 коммутатора msk-donskaya-sw-4](image/2.png)

## Выполнение лабораторной работы

С оконечного устройства dk-donskaya-1 пропингуем серверы mail и web 

## Выполнение лабораторной работы

![Пингование сервера mail и web](image/4.png)

В режиме симуляции проследим движение пакетов ICMP. Убедимся, что движение пакетов происходит через коммутатор msk-donskaya-sw-2 

## Выполнение лабораторной работы 

![Режим симуляции движения пакетов ICMP](image/5.png)

## Выполнение лабораторной работы

![Режим симуляции движения пакетов ICMP](image/6.png)

На коммутаторе msk-donskaya-sw-2 посмотрим состояние протокола STP для vlan 3 (рис. [-@fig:008]):

## Выполнение лабораторной работы

![Просмотр состояния протокола STP для vlan 3](image/8.png)

В качестве корневого коммутатора STP настроем коммутатор msk-donskaya-sw-1 (рис. [-@fig:009]):

## Выполнение лабораторной работы

![Настройка коммутатора msk-donskaya-sw-1 корневым](image/22.png)

Используя режим симуляции, убедимся, что пакеты ICMP пойдут от
хоста dk-donskaya-1 до mail через коммутаторы msk-donskaya-sw-1 и mskdonskaya-sw-3, а от хоста dk-donskaya-1 до web через коммутаторы
msk-donskaya-sw-1 и msk-donskaya-sw-2 

## Выполнение лабораторной работы

![Режим симуляции движения пакетов ICMP к серверу web](image/7.png)

## Выполнение лабораторной работы

![Режим симуляции движения пакетов ICMP к серверу mail](image/8.png)

Настроим режим Portfast на тех интерфейсах коммутаторов, к которым
подключены серверы 

## Выполнение лабораторной работы

![Настройка режима Portfast](image/9.png)

## Выполнение лабораторной работы

![Настройка режима Portfast](image/10.png)

Изучим отказоустойчивость протокола STP и время восстановления соединения при переключении на резервное соединение. Для этого используем
команду `ping -n 1000 mail.donskaya.rudn.ru` на хосте dk-donskaya-1 (рис. [-@fig:014]),
а разрыв соединения обеспечим переводом соответствующего интерфейса
коммутатора в состояние shutdown (рис. [-@fig:015]).

## Выполнение лабораторной работы

![Пингование mail.donskaya.rudn.ru](image/20.png)

## Выполнение лабораторной работы

![Разрыв соединения](image/24.png)

Видно, что на время восстановления соединения потребовалось 4 пинга, что достаточно долго (рис. [-@fig:016]). После восстановление пингование продолжило работать, как и в начале.

## Выполнение лабораторной работы

![Время восстановления соединения](image/25.png)

Переключим коммутаторы в режим работы по протоколу Rapid PVST+ 

## Выполнение лабораторной работы

![Режим работы по протоколу Rapid PVST+](image/26.png)

## Выполнение лабораторной работы

![Режим работы по протоколу Rapid PVST+](image/27.png)

## Выполнение лабораторной работы

![Режим работы по протоколу Rapid PVST+](image/28.png)

## Выполнение лабораторной работы

![Режим работы по протоколу Rapid PVST+](image/29.png)

## Выполнение лабораторной работы

![Режим работы по протоколу Rapid PVST+](image/30.png)

Изучим теперь отказоустойчивость протокола Rapid PVST+ и время восстановления соединения при переключении на резервное соединение 

## Выполнение лабораторной работы

![Пингование mail.donskaya.rudn.ru](image/31.png)

Сразу после разрыва соединения задержки по времени вообще не было, сесть моментально перестроилась.

А вот, когда обратно вернули старое соединение потребовался 1 пинг, что достаточно быстро (рис. [-@fig:024]). После восстановление пингование продолжило работать, как и в начале.

## Выполнение лабораторной работы

![Время восстановления соединения](image/32.png)

Сформируем агрегированное соединение интерфейсов Fa0/20 – Fa0/23
между коммутаторами msk-donskaya-sw-1 и msk-donskaya-sw-4 (рис. [-@fig:029]).

## Выполнение лабораторной работы

![Логическая схема локальной сети с агрегированным соединением](image/33.png)

Настроим агрегирование каналов (режим EtherChannel) (рис. [-@fig:024--@fig:028]):

## Выполнение лабораторной работы

![Настройка агрегирования каналов на msk-donskaya-cahanqirov-sw-1](image/34.png)

## Выполнение лабораторной работы

![Настройка агрегирования каналов на msk-donskaya-cahanqirov-sw-4](image/36.png)

## Выводы

В результате выполнения лабораторной работы я изучил возможности протокола STP и его модификаций по обеспечению
отказоустойчивости сети, агрегированию интерфейсов и перераспределению нагрузки между ними.

